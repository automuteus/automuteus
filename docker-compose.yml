version: "3"

services:
  automuteus:
    image: denverquane/amongusdiscord:${AUTOMUTEUS_TAG}
    restart: always
    ports:
      # 5000 is the default service port
      # Format is HostPort:ContainerPort
      - 5000:5000
    environment:
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN}
      - DISCORD_BOT_TOKEN_2=${DISCORD_BOT_TOKEN_2}
      - HOST=${HOST}
      - REDIS_ADDRESS=${REDIS_ADDRESS}
      # Add other variables as desired here. Either explicitly (like the REDIS_ADDRESS above is),
      # or by providing an equivalent mapping in the `.env` file
    depends_on:
      - redis
      - galactus
  galactus:
    ports:
      - ${EXTERNAL_PORT}:${BROKER_PORT}
    image: automuteus/galactus:${GALACTUS_TAG}
    restart: always
    environment:
      - BROKER_PORT=${BROKER_PORT}
      - REDIS_ADDRESS=${REDIS_ADDRESS}
    depends_on:
      - redis

  redis:
    image: redis:alpine
    restart: always